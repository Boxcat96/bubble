close all

% GDP growth
%zz = [2.2473	-0.53939	0.48927	-1.28343	0.67503	1.69748	1.91964	1.96111	1.7836	0.90367	1.22851	0.32886	1.09161	1.12212	2.19843	0.6556	2.10828	1.0887	1.5623	0.30889	2.41977	1.26327	2.22327	2.30404	2.43423	0.34162	0.84691	0.82037	0.88559	0.06127	0.94613	0.75402	2.03949	1.67081	0.77497	0.3933	1.56511	0.30401	0.66051	-0.48769	-0.14848	0.14192	0.92158	-1.07164	2.71599	0.54111	0.82298	0.23578	1.83895	2.26976	0.94439	1.67446	2.47481	1.08865	-0.5259	0.94923	-0.85977	0.23768	-0.94513	-0.38814	-1.2173	0.71454	1.71166	1.34651	2.24876	0.7337	0.54872	0.72485	1.18149	1.94411	1.80435	0.00219	0.31918	3.86425	1.00552	1.34415	0.17978	0.10693	0.74287	0.25007	0.31452	-2.06048	-0.11885	1.86493	1.95944	-0.74108	1.19752	-1.08955	-1.55354	0.4562	-0.3823	0.03994	1.31785	2.27561	1.99907	2.08622	1.95477	1.72779	0.96406	0.82086	0.96909	0.88046	1.52712	0.74329	0.9335	0.45038	0.95703	0.53708	0.74517	1.0789	0.86761	1.71705	0.51663	1.31387	0.58593	1.3325	1.0166	0.76327	0.74088	0.19705	1.09279	0.36291	0.06652	-0.91038	-0.46784	0.77972	0.5053	0.3485	1.19705	1.08435	0.98827	1.04316	0.1674	0.58242	0.47731	1.36011	0.97022	1.35505	0.58452	1.14552	0.35476	0.29834	0.85068	0.67902	0.74895	1.66785	0.89699	1.03838	0.64556	1.662	1.25085	0.85882	0.99948	0.92581	1.25257	1.61588	0.94647	0.76916	1.30966	1.69959	0.36176	1.83116	0.13356	0.62289	-0.28518	0.58456	-0.41504	0.27237	0.87451	0.60573	0.44457	0.15482	0.55477	0.86026	1.69821	1.14817	0.53375	0.76208	0.94533	1.00167	1.10696	0.46156	0.89133	0.63146	1.33029	0.2337	0.15463	0.85187	0.23549	0.57287	0.54327	0.60784	-0.5747	0.51639	-0.54136	-2.16381	-1.1227	-0.14399	0.36411	1.09838	0.38478	0.92203	0.73721	0.5019	-0.24044	0.71497	-0.02778	1.15928	0.78299	0.4302	0.13495	0.11387	0.88568	0.1234	0.78342	0.79825	-0.25176	1.25387	1.20891	0.47185	0.82272	0.82461	0.24012	0.09991	0.38467	0.5656	0.47791	0.43757	0.4433	0.73967	0.69848	0.56794];


% output growth
zztemp = zz(1,:)' ;

% zzd = [zztemp zztemp1] ;
time = 1965.0:.25:2019.75 ;
t15  = find(time == 2015.5) ;
t65 = find(time == 1965) ;
t84 = find(time == 1984) ;
t94 = find(time == 1994.00) ;
t70 = find(time == 1970) ;
t01 = find(time == 2001.5) ;
t08 = find(time == 2008) ;
t10 = find(time == 2010) ;

%zzd = zztemp(t84:end) ;
zzd = zztemp;

%credit-gdp ratio 1960 - 2017Q4
%zzcredit = [0.0132605887047995,0.0309450350364897,0.0340350839497913,0.0550623508257917,0.0489377755348314,0.0471630409842045,0.0405381980771242,0.0408247395544956,0.0256972453769115,0.0339038402710502,0.0365727960842660,0.0506547492964211,0.0441253285805191,0.0524743105967397,0.0483792210133096,0.0572778251744118,0.0440483541596364,0.0527641619652943,0.0503985962540680,0.0634594994319367,0.0487839488056557,0.0547914490044267,0.0471537761635381,0.0418406035319356,0.0272885916355923,0.0399068423462605,0.0336390709715416,0.0326053018273116,0.0260795716827918,0.0383012801765834,0.0324889124505151,0.0463920356657361,0.0163109733833159,0.0154580668612979,0.0130997756208037,0.0208763355402835,0.00381575757485475,0.0131245689965031,0.00705802883179074,0.0186775532421126,0.00866624337083866,0.0133910548266984,0.0102218447255308,0.0221798080163386,-0.00672592808645101,-0.000441290004427497,0.000652816857121708,0.0102450160712242,-0.00605610145943714,-0.00367211306035198,-0.00200725836278970,-0.000325747232334361,-0.0107072990852655,-0.00440829952915056,0.00772147655876798,0.00165403753580584,0.00509088677729974,0.0106742858934981,0.0131446852185101,0.00659618722464461,-0.00178580440302978,-0.0105115846910343,-0.0304800451797096,-0.0419590893919815,-0.0637608556729972,-0.0574631832817276,-0.0558379388560007,-0.0558398318385888,-0.0626779273694919,-0.0620931518997429,-0.0635661530746189,-0.0531576190911276,-0.0500562732886162,-0.0663669728099732,-0.0629775128912530,-0.0668834181654310,-0.0644170548255345,-0.0539807192271192,-0.0509590247185527,-0.0477997695473743,-0.0497084684419847,-0.0400293321943569,-0.0427498648879106,-0.0627701603610725,-0.0942363976230528,-0.0786113873756592,-0.0853431963205316,-0.0746051096211259,-0.0613631630407709,-0.0602418214367554,-0.0605147916987391,-0.0602945870822864,-0.0733020535355351,-0.0804488691852255,-0.0865840466861919,-0.0856160137227859,-0.0922137908316972,-0.0821414572943832,-0.0738589550935815,-0.0539356796157329,-0.0496475490580872,-0.0354720690950237,-0.0309470135653478,-0.00493552983621104,-0.00509093339192290,0.0140630748105723,0.0262736218213779,0.0484217616677372,0.0420255654300441,0.0490802509252146,0.0524162184534387,0.0407950194434481,0.0438345353398273,0.0460886501394846,0.0470246638390552,0.0478159319299365,0.0379482042713231,0.0408306418009239,0.0383519653153466,0.0474146040728856,0.0372881620441599,0.0351744887338872,0.0353476232139929,0.0444474339967798,0.0335049246627512,0.0243473910282781,0.00781504261165944,-0.00224698945617630,-0.0209676180678502,-0.0378534990333352,-0.0505834026186736,-0.0630023156780784,-0.0696801632496780,-0.0709836440931400,-0.0705620391727297,-0.0775704024979735,-0.0833277273787936,-0.0898769798601351,-0.0892902536693239,-0.0896235157763001,-0.0896758392197419,-0.0799603016096395,-0.0805432687261507,-0.0787695607928221,-0.0813777554880921,-0.0879055337718391,-0.0883880053463064,-0.0942423097242899,-0.0990022471545331,-0.100996609955417,-0.0993760830607215,-0.0944394820565961,-0.0884439521665366,-0.0728096915234811,-0.0736211177684412,-0.0722141145525206,-0.0644689046102196,-0.0551312820152210,-0.0430205355697331,-0.0460898335402074,-0.0333007763266286,-0.0360334599583392,-0.0232403231723837,-0.0187250034553077,-0.0169863005591553,-0.00686878017191028,0.0178423509203096,0.0240664792047141,0.0191985669213914,0.0230295211159988,0.0256989366741094,0.0418582352696060,0.0406661310743297,0.0549766271040584,0.0448863061721434,0.0397172170672153,0.0435097896129757,0.0487093363920441,0.0533091007811233,0.0666131971005473,0.0597583505297190,0.0757676708912654,0.0824604072590309,0.0946095450630249,0.100414180802662,0.120968047985523,0.138908623191183,0.155231811670227,0.161255590503627,0.178473647433181,0.195857387191932,0.212545571535677,0.232480211871559,0.221182165142029,0.231957751671494,0.242839150695826,0.240408290752543,0.234398110637357,0.213933378672854,0.173680826157588,0.146078198185935,0.110482107652106,0.0901264238805772,0.0614394063935992,0.0552349700491459,0.0274828359489305,0.0117613669095513,-0.00390754206487864,-0.0217615577296080,-0.0323491272524412,-0.0374277545162416,-0.0315203307551473,-0.0490587472837190,-0.0492316947827707,-0.0545058540558903,-0.0707499951850807,-0.0679920022135316,-0.0783524251198580,-0.0904590318040406,-0.0872448389110292,-0.0905561437092783,-0.0896308380283306,-0.0916860532631878,-0.0881243039872675,-0.0796578434674200,-0.0833505623694060,-0.0838748541321004,-0.0903410288696256,-0.0895700446722614,-0.0893628130668351,-0.0943514946180262,-0.0991778137327641] ;
% stock market-gdp ratio 1984Q1 - 2017Q4
%zzstock  = [-5.76001437592306,-6.82980018854889,-7.67229496557115,-3.74067420851281,-2.77826148951520,-4.43090400946045,-4.09559271744045,4.16286639932035,10.9077933326078,7.27978198147704,4.61685918689521,15.2950451022109,16.1624719695454,20.9808700873053,-5.24758933548900,-5.38439067254270,-5.56257242225521,-6.52720598297825,-7.46048062504612,-4.51558810069682,0.693396402735431,6.72225727984320,5.62154773935650,-0.645852487149561,0.148917200233576,-6.21075989974352,-14.1979628320749,-3.61386485144796,2.31131056205200,2.13502448581059,1.73731315519628,6.75190273520411,2.05376204451145,0.602032780291310,0.323831698907831,3.67787439446404,1.59080469996268,1.86481359073878,0.889694585186206,-0.980760214496833,-9.24958594370633,-10.6572712790756,-14.9778664701114,-14.3278204577584,-9.56848443810993,-4.94883538715596,-4.08156705089839,-2.42077023575748,-2.64718841329636,-8.01380370023532,-4.12296892544143,-1.66942995415842,-3.06832897831904,5.55338660257839,4.76709670511731,7.52790737318183,11.6423534979122,3.56135034529137,1.81558794809947,11.0579437522567,14.4506735058007,12.8519514025620,13.8850587942647,20.5696704327608,16.7216531572721,19.6448440085248,10.6781465795352,4.01474536941760,1.30026379783223,-3.49572309911438,-6.00816507154745,-2.82930522229448,-6.49274509379301,-23.6271362062807,-24.1260889125970,-26.5117657953855,-17.4100303179516,-10.8863966006259,-5.57213528587218,0.986857309549789,-0.988172326962609,-4.14989619767079,0.581444978907165,1.79808242031885,0.337335259112054,3.49957033333362,3.00755757038493,6.31824394623576,5.70981880910932,4.92935405973176,12.0825130492244,14.7134897871021,19.1467811944402,18.1568632175898,18.6736336233056,9.46763933773136,11.5078206259823,3.69929360932411,-27.0308373346276,-36.5749971043823,-24.7901264150600,-13.4284635007086,-5.85618177977307,-2.69852000565701,-2.82943543537559,-8.14990143968310,0.215251098016306,6.88528698284954,5.52147887989689,-4.30425275984593,-7.68806764990113,-0.831078827007481,-3.85748138186086,-3.01233455858455,-4.19561415681904,-0.0209306184197708,3.54883605557576,4.95498957760544,7.26070978775890,9.35364821150851,8.17291893780146,8.29130607488897,6.82208535686464,7.40395188270922,6.51066896646841,0.210418651690475,-1.47719385824407,-9.76069816085262,-5.74047049376188,-3.64226516277014,-4.70151607405412,-0.994112407740097,-0.691327774673447,-0.967994305205519,1.27436871660626,3.13482894981891] ;

clear zztemp zztemp1 mmx
zzd = [zzd zzstock'] ;

% compute some mean to match in estimation

for tx = 20:size(zzd,1)
    meanout(tx) = mean(zzd(tx-19:tx,1)) ;
    meancrd(tx) = mean(zzd(tx-19:tx,2)) ;
end

for tx = 40:size(zzd,1)
    meanout1(tx) = mean(zzd(tx-39:tx,1)) ;
    meancrd1(tx) = mean(zzd(tx-39:tx,2)) ;
end

meanout2 = meanout1 ;
meanout2(t01:t08) = NaN ;

time1 = 1965.0:.25:2022.75 ;
t01a = find(time1 == 2001.5) ;
t08a = find(time1 == 2008) ;
t10a = find(time1 == 2010) ;
t02  = find(time1 == 2002) ;
t07  = find(time1 == 2007.75) ;
t09  = find(time1 == 2009.5) ;

figure
subplot(2,1,1)
hold on
plot(time(t94:end),zzd(:,1),'LineWidth',2)
% plot(time(t65:end),zzd(:,1),'LineWidth',2)
title('実質GDP成長率（季節調整済）')
% plot(time1(t01a:6:t08a),meanout1(t01a:6:t08a),'ko','LineWidth',2)
% plot(time1(t10a:6:end),meanout1(t10a:6:end),'kd','LineWidth',2)
axis tight
grid on
box on

subplot(2,1,2)
hold on
plot(time(t94:end),zzd(:,2),'LineWidth',2)

title('日経平均株価（対GDP比率）')
axis tight
grid on
box on
% sgtitle("図表１：推計に用いるデータ")

exportgraphics(gcf,'graph/eps/data.eps')
exportgraphics(gcf,'graph/data.png','Resolution',300)

return ;